"use strict";(self["webpackChunktoutiao_m"]=self["webpackChunktoutiao_m"]||[]).push([[726],{9726:function(t,e,s){s.r(e),s.d(e,{default:function(){return $}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-container"},[e("form",{attrs:{action:"/"}},[e("van-search",{attrs:{background:"#3296fa",placeholder:"请输入搜索关键词","show-action":""},on:{search:t.onSearch,cancel:t.onCancel,focus:function(e){t.isResultShow=!1}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1),t.isResultShow?e("searchResult",{attrs:{searchText:t.searchText}}):t.searchText?e("searchSuggestion",{attrs:{searchText:t.searchText},on:{search:t.onSearch}}):e("searchHistory")],1)},n=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-history"},[e("van-cell",{attrs:{title:"单元格"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[e("span",[t._v("全部删除")]),e("span",[t._v("完成")]),e("van-icon",{staticClass:"delete-icon",attrs:{name:"delete"}})]},proxy:!0}])}),e("van-cell",{attrs:{title:"hello"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[e("van-icon",{staticClass:"delete-icon",attrs:{name:"close"}})]},proxy:!0}])})],1)},i=[],o={name:"SearchHistory",data(){return{}},methods:{}},c=o,l=s(1001),h=(0,l.Z)(c,r,i,!1,null,"8dce8394",null),u=h.exports,d=function(){var t=this,e=t._self._c;return e("div",t._l(t.suggestionList,(function(s,a){return e("van-cell",{key:a,attrs:{title:s,icon:"search"},on:{click:function(e){return t.$emit("search",s)}},scopedSlots:t._u([{key:"title",fn:function(){return[e("span",{domProps:{innerHTML:t._s(t.hightLight(s))}})]},proxy:!0}],null,!0)})})),1)},p=[],g=s(432),f=s(4806),x={name:"searchSuggestion",props:{searchText:{type:String,default:""}},data(){return{suggestionList:[]}},watch:{searchText:{handler:(0,f.debounce)((function(t){this.loadSearchSuggestion(t)}),200),immediate:!0}},methods:{async loadSearchSuggestion(t){try{const{data:e}=await(0,g.Cc)(t);console.log(e),e.data.options&&null==e.data.options[0]&&(e.data.options[0]=this.searchText),this.suggestionList=e.data.options}catch(e){this.$toast("获取搜索失败")}},hightLight(t){const e=`<span style="color: red">${this.searchText}</span>`,s=t.split(this.searchText);return s.join(e)}}},v=x,S=(0,l.Z)(v,d,p,!1,null,"01c55540",null),m=S.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-result"},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t){return e("van-cell",{key:t.art_id,attrs:{title:t.title}})})),1)],1)},y=[],T={name:"searchResult",props:{searchText:{type:String,default:""}},data(){return{page:1,perPage:20,list:[],loading:!1,finished:!1,err:!1}},methods:{async onLoad(){try{const{data:t}=await(0,g.Sx)({page:this.page,per_page:this.perPage,q:this.searchText});this.list.push(...t.data.results),this.loading=!1,t.data.results.length?this.page++:this.finished=!0}catch(t){this.err=!0,this.loading=!1,this.$toast("请求失败, 请重试")}}}},k=T,w=(0,l.Z)(k,_,y,!1,null,"389746e3",null),C=w.exports,L={name:"searchIndex",components:{searchHistory:u,searchSuggestion:m,searchResult:C},data(){return{searchText:"",isResultShow:!1}},methods:{onSearch(t){this.searchText=t,this.isResultShow=!0,console.log(t)},onCancel(){this.$router.back()}}},b=L,R=(0,l.Z)(b,a,n,!1,null,"23040052",null),$=R.exports}}]);
//# sourceMappingURL=726.f16aeb49.js.map